---

# -------------------- users

- schema: User
  name: mhentsc3
  data:
    id: 12
    name: Maik Hentsche
    login: mhentsc3
    password: verysecret

# -------------------- topics

- schema: Topic
  name: software
  data:
    name: Software
    description: any non-kernel software, e.g., libraries, programs

# -------------------- testruns "perfmon", "lmbench"

- schema: Testrun
  name: Xen
  data:
    id: 1
    owner_user_id: 12
    shortname: Xen
    notes: Xen test
    topic_name: Software

# -------------------- preconditions



# ------------------------------------------------------------
# 
#    Virtualisation test (i.e. Xen and KVM)
#
# ------------------------------------------------------------

- schema: Testrun
  name: Xen
  data:
    id: 2
    owner_user_id: 12
    shortname: KVM
    notes: KVM test
    topic_name: Software


- schema: Testrun
  name: Reboot
  data:
    id: 3
    owner_user_id: 12
    shortname: reboot
    topic_name: Misc

- schema: Testrun
  name: KVM_autoinstall
  data:
    id: 4
    owner_user_id: 12
    shortname: KVM_auto
    notes: Install KVM using autoinstaller
    topic_name: Software

- schema: Testrun
  name: KVM_alt_images
  data:
    id: 5
    owner_user_id: 12
    shortname: alt_img
    notes: Tests virt precondition with multiple alternatives for partition name
    topic_name: KVM

- schema: Testrun
  name: Xen_Windows
  data:
    id: 6
    owner_user_id: 12
    shortname: xen_win
    notes: Tests virt precondition with windows guest
    topic_name: Xen



# -------------------- preconditions

- schema: Precondition
  name: KVMtest
  data:
    id: 8
    shortname: KVM
    precondition: |
       name: automatically generated KVM test
       precondition_type: virt
       host:
         preconditions:
         - filename: linux-2.6.23.9.tar.gz
           path: /data/bancroft/artemis/live/repository/packages/kvm/
           precondition_type: package
         - filename: kvm.tar.gz
           path: /data/bancroft/artemis/live/repository/packages/kvm/
           precondition_type: package
         - line: natrium:/vol/osrc_home/ /home nfs auto,defaults 0 0
           precondition_type: fstab
         root:
           image: suse/suse_sles10_64b_smp_raw.tar.gz
           mount: /
           partition: testing
           arch: linux64
           precondition_type: image
       guests:
       - config:
           dest: /kvm/images
           name: /bin/true
           precondition_type: copyfile
           protocol: local
           exec: /usr/share/artemis/packages/mhentsc3/startkvm.pl
         root:
           dest: /kvm/images
           mountfile: /kvm/images/raw.img
           mounttype: raw
           name: osko:/export/image_files/official_testing/redhat_rhel5u2_64b_smp_up_qcow.img
           precondition_type: copyfile
           protocol: nfs
           arch: linux64
         testprogram:
           execname: /home/artemis/x86_64/bin/artemis_testsuite_kernbench.sh
           timeout_testprogram: 36000

- schema: Precondition
  name: KVM_autoinstall
  data:
    id: 101
    shortname: KVM-auto
    precondition: |
       name: automatically generated KVM test
       precondition_type: virt
       host:
         preconditions:
         - filename: linux-2.6.23.9.tar.gz
           path: /data/bancroft/artemis/live/repository/packages/kvm/
           precondition_type: package
         - filename: kvm.tar.gz
           path: /data/bancroft/artemis/live/repository/packages/kvm/
           precondition_type: package
         - line: natrium:/vol/osrc_home/ /home nfs auto,defaults 0 0
           precondition_type: fstab
         root:
           precondition_type: autoinstall
           name: RHEL5
           timeout: 10000
           grub_text: |
             timeout 2
             
             title RHEL 5
             kernel /tftpboot/stable/rhel/5/x86_64/vmlinuz  console=ttyS0,115200 ks=http://bancroft/autoinstall/stable/rhel/5/x86_64/artemis-ai.ks ksdevice=eth0 noapic $ARTEMIS_OPTIONS
             initrd /tftpboot/stable/rhel/5/x86_64/initrd.img
       guests:
       - config:
           dest: /kvm/images
           name: /bin/true
           precondition_type: copyfile
           protocol: local
           exec: /usr/share/artemis/packages/mhentsc3/startkvm.pl
         root:
           dest: /kvm/images
           mountfile: /kvm/images/raw.img
           mounttype: raw
           name: osko:/export/image_files/official_testing/redhat_rhel5u2_64b_smp_up_qcow.img
           precondition_type: copyfile
           protocol: nfs
           arch: linux64
         testprogram:
           execname: /home/artemis/x86_64/bin/artemis_testsuite_kernbench.sh
           timeout_testprogram: 36000


- schema: Precondition
  name: installer stop
  data:
    id: 10
    precondition: |
      precondition_type: installer_stop

- schema: Precondition
  name: reboot
  data:
    id: 11
    precondition: |
      precondition_type: reboot
      count: 2

- schema: Precondition
  name: simple_image
  data:
    id: 12
    precondition: |
      precondition_type: image
      arch: linux64
      mount: /
      partition: testing


- schema: Precondition
  name: KVMtest
  data:
    id: 110
    shortname: KVM
    precondition: |
       name: automatically generated KVM test
       precondition_type: virt
       host:
         preconditions:
         - filename: linux-2.6.23.9.tar.gz
           path: /data/bancroft/artemis/live/repository/packages/kvm/
           precondition_type: package
         - filename: kvm.tar.gz
           path: /data/bancroft/artemis/live/repository/packages/kvm/
           precondition_type: package
         - line: natrium:/vol/osrc_home/ /home nfs auto,defaults 0 0
           precondition_type: fstab
         root:
           image: suse/suse_sles10_64b_smp_raw.tar.gz
           mount: /
           partition: 
             - testing
             - /dev/sda2
             - /dev/hda2
           arch: linux64
           precondition_type: image
       guests:
       - config:
           dest: /kvm/images
           name: /bin/true
           precondition_type: copyfile
           protocol: local
           exec: /usr/share/artemis/packages/mhentsc3/startkvm.pl
         root:
           dest: /kvm/images
           mountfile: /kvm/images/raw.img
           mounttype: raw
           name: osko:/export/image_files/official_testing/redhat_rhel5u2_64b_smp_up_qcow.img
           precondition_type: copyfile
           protocol: nfs
           arch: linux64
         testprogram:
           execname: /home/artemis/x86_64/bin/artemis_testsuite_kernbench.sh
           timeout_testprogram: 36000

- schema: Precondition
  name: KVMtest
  data:
    id: 111
    shortname: Xen
    precondition: |
      name: automatically generated Xen test
      precondition_type: virt
      host: 
        root: 
          arch: linux32
          image: suse/suse_sles10_sp2_32b_smp_raw.tar.gz
          mount: /
          partition: /dev/sda2
          precondition_type: image
        testprogram: 
          execname: /opt/artemis/bin/metainfo
          runtime: 50
          timeout_testprogram: 300
      guests: 
        - config: 
            dest: /xen/images/
            name: bancroft:/data/bancroft/artemis/live/repository/configs/xen/002-uruk-1268101895.svm
            precondition_type: copyfile
            protocol: nfs
            svm: /xen/images//002-uruk-1268101895.svm
          root: 
            arch: linux32
            dest: /xen/images/
            mountfile: /xen/images/002-uruk-1268101895.img
            mounttype: windows
            name: osko:/export/image_files/official_testing/redhat_rhel6_alpha3_32b_qcow.img
            precondition_type: copyfile
            protocol: nfs
          testprogram: 
            execname: /opt/artemis/bin/py_reaim
            runtime: 28800
            timeout_testprogram: 36000


# -------------------- "KVM" <== "KVMtest"

- schema: TestrunPrecondition
  name: 1st precondition for KVM
  data:
    testrun_id: 2
    precondition_id: 8
    succession: 1


- schema: TestrunPrecondition
  name: 2nd precondition for KVM
  data:
    testrun_id: 2
    precondition_id: 10
    succession: 2


# -------------------- "Reboot" <== "Reboot"

- schema: TestrunPrecondition
  name: 1st precondition for Reboot
  data:
    testrun_id: 3
    precondition_id: 11
    succession: 1


- schema: TestrunPrecondition
  name: 2nd precondition for reboot
  data:
    testrun_id: 3
    precondition_id: 12
    succession: 2


# -------------------- Preconditions for KVM_auto

- schema: TestrunPrecondition
  name: precondition for KVM_auto
  data:
    testrun_id: 4
    precondition_id: 101
    succession: 1

# -------- image with partition alternatives

- schema: TestrunPrecondition
  name: precondition for KVM_auto
  data:
    testrun_id: 5
    precondition_id: 110
    succession: 1

- schema: TestrunPrecondition
  name: precondition for KVM_auto
  data:
    testrun_id: 6
    precondition_id: 111
    succession: 1
